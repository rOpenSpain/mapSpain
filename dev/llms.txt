# mapSpain

[**mapSpain**](https://ropenspain.github.io/mapSpain/) is a package that
provides spatial **sf** objects of Spain’s administrative boundaries,
including Autonomous Communities, provinces, and municipalities.

**mapSpain** also provides a Leaflet plugin to be used with the
[**leaflet** package](https://rstudio.github.io/leaflet/), which loads
several base maps from Spain’s public institutions and enables
downloading and processing of static tiles.

Full site with examples and vignettes on
<https://ropenspain.github.io/mapSpain/>

## Installation

Install **mapSpain** from
[**CRAN**](https://CRAN.R-project.org/package=mapSpain):

``` r
install.packages("mapSpain", dependencies = TRUE)
```

You can install the developing version of **mapSpain** using the
[r-universe](https://ropenspain.r-universe.dev/mapSpain):

``` r
# Install mapSpain in R:
install.packages("mapSpain",
  repos = c(
    "https://ropenspain.r-universe.dev",
    "https://cloud.r-project.org"
  ),
  dependencies = TRUE
)
```

Alternatively, you can install the developing version of **mapSpain**
with:

``` r
# install.packages("pak")
pak::pak("rOpenSpain/mapSpain", dependencies = TRUE)
```

## Usage

This script highlights some features of **mapSpain** : key features of
**mapSpain**

``` r
library(mapSpain)
library(sf)
library(dplyr)
census <- mapSpain::pobmun25 |>
  select(-name)

# Extract CCAA from base dataset

codelist <- mapSpain::esp_codelist |>
  select(cpro, codauto) |>
  distinct()

census_ccaa <- census |>
  left_join(codelist) |>
  # Summarize by CCAA
  group_by(codauto) |>
  summarise(pob25 = sum(pob25), men = sum(men), women = sum(women)) |>
  mutate(
    porc_women = women / pob25,
    porc_women_lab = paste0(round(100 * porc_women, 2), "%")
  )


# Merge into spatial data

ccaa_sf <- esp_get_ccaa() |>
  left_join(census_ccaa)
can <- esp_get_can_box()


# Plot with ggplot
library(ggplot2)


ggplot(ccaa_sf) +
  geom_sf(aes(fill = porc_women), color = "grey70", linewidth = .3) +
  geom_sf(data = can, color = "grey70") +
  geom_sf_label(aes(label = porc_women_lab),
    fill = "white", alpha = 0.5,
    size = 3, linewidth = 0
  ) +
  scale_fill_gradientn(
    colors = hcl.colors(10, "Blues", rev = TRUE),
    n.breaks = 10, labels = scales::label_percent(),
    guide = guide_legend(title = "% women", position = "inside")
  ) +
  theme_void() +
  theme(legend.position.inside = c(0.1, 0.6)) +
  labs(caption = "Source: CartoBase ANE 2006-2024 CC-BY 4.0 ign.es, INE")
```

![Porc. of women by CCAA in Spain
(2025)](reference/figures/README-static-1.png)

You can combine `sf` objects with static tiles

``` r
# Get census
census <- mapSpain::pobmun25 |>
  mutate(porc_women = women / pob25) |>
  select(cpro, cmun, porc_women)

# Get shapes
shape <- esp_get_munic_siane(region = "Segovia", epsg = 3857)
provs <- esp_get_prov_siane(epsg = 3857)

shape_pop <- shape |> left_join(census)


tile <- esp_get_tiles(shape_pop, type = "IDErioja.Relieve", zoommin = 1)

# Plot

library(ggplot2)
library(tidyterra)

lims <- as.vector(terra::ext(tile))

ggplot(remove_missing(shape_pop, na.rm = TRUE)) +
  geom_spatraster_rgb(data = tile, maxcell = 10e6) +
  geom_sf(aes(fill = porc_women), color = NA) +
  geom_sf(data = provs, fill = NA) +
  scale_fill_gradientn(
    colours = hcl.colors(10, "RdYlBu", alpha = .5),
    n.breaks = 8,
    labels = function(x) {
      sprintf("%1.0f%%", 100 * x)
    },
    guide = guide_legend(title = "", )
  ) +
  coord_sf(
    xlim = lims[c(1, 2)],
    ylim = lims[c(3, 4)],
    expand = FALSE
  ) +
  labs(
    title = "% women in Segovia by town (2025)",
    caption = paste0(
      "Source: INE, CC BY 4.0 www.iderioja.org, ",
      "CartoBase ANE 2006-2024 CC-BY 4.0 ign.es"
    )
  ) +
  theme_void() +
  theme(
    title = element_text(face = "bold")
  )
```

![Perc. of women in Segovia by town
(2025)](reference/figures/README-tile-1.png)

## mapSpain and giscoR

If you need to plot Spain alongside other countries, consider using the
[**giscoR**](https://ropengov.github.io/giscoR/) package, which is
installed as a dependency with **mapSpain**. Here’s a basic example:

``` r
library(giscoR)

# Set the same resolution for a perfect fit

res <- "20"

all_countries <- gisco_get_countries(resolution = res) |>
  st_transform(3035)

eu_countries <- gisco_get_countries(resolution = res, region = "EU") |>
  st_transform(3035)

ccaa <- esp_get_ccaa(moveCAN = FALSE, resolution = res) |>
  st_transform(3035)

library(ggplot2)

ggplot(all_countries) +
  geom_sf(fill = "#DFDFDF", color = "#656565") +
  geom_sf(data = eu_countries, fill = "#FDFBEA", color = "#656565") +
  geom_sf(data = ccaa, fill = "#C12838", color = "grey80", linewidth = .1) +
  # Center in Europe: EPSG 3035
  coord_sf(xlim = c(2377294, 7453440), ylim = c(1313597, 5628510)) +
  theme(
    panel.background = element_blank(),
    panel.grid = element_line(colour = "#DFDFDF", linetype = "dotted")
  ) +
  labs(caption = giscoR::gisco_attributions("es"))
```

![Locator map of Spain](reference/figures/README-giscoR-1.png)

## A note on caching

Some data sets and tiles may have a size larger than 50MB. You can use
**mapSpain** to create your own local repository at a given local
directory passing the following option:

``` r
esp_set_cache_dir("./path/to/location")
```

When this option is set, **mapSpain** will look for the cached file and
load it, which speeds up the process.

## Citation

Hernangómez D (2026). *mapSpain: Administrative Boundaries of Spain*.
[doi:10.5281/zenodo.5366622](https://doi.org/10.5281/zenodo.5366622),
<https://ropenspain.github.io/mapSpain/>.

A BibTeX entry for LaTeX users is:

``` R
@Manual{R-mapspain,
  title = {{mapSpain}: Administrative Boundaries of Spain},
  year = {2026},
  version = {0.99.99.9000},
  author = {Diego Hernangómez},
  doi = {10.5281/zenodo.5366622},
  url = {https://ropenspain.github.io/mapSpain/},
  abstract = {Administrative Boundaries of Spain at several levels (Autonomous Communities, Provinces, Municipalities) based on the GISCO Eurostat database <https://ec.europa.eu/eurostat/web/gisco> and CartoBase SIANE from Instituto Geografico Nacional <https://www.ign.es/>. It also provides a leaflet plugin and the ability of downloading and processing static tiles.},
}
```

## Contribute

Check the GitHub page for [source
code](https://github.com/ropenspain/mapSpain/).

## Copyright notice

This package uses data from CartoBase SIANE, provided by Instituto
Geográfico Nacional:

> Atlas Nacional de España (ANE) [CC BY
> 4.0](https://creativecommons.org/licenses/by/4.0/deed.en)
> [ign.es](https://www.ign.es/)

See <https://github.com/rOpenSpain/mapSpain/tree/sianedata>

This package also uses data from **GISCO**. GISCO
[(FAQ)](https://ec.europa.eu/eurostat/web/gisco) is a geospatial open
data repository containing multiple datasets at various resolution
levels.

*From GISCO \> Geodata \> Reference data \> Administrative Units /
Statistical Units*

> When data downloaded from this page is used in any printed or
> electronic publication, in addition to any other provisions applicable
> to the whole Eurostat website, data source will have to be
> acknowledged in the legend of the map and in the introductory page of
> the publication with the following copyright notice:
>
> EN: © EuroGeographics for the administrative boundaries
>
> FR: © EuroGeographics pour les limites administratives
>
> DE: © EuroGeographics bezüglich der Verwaltungsgrenzen
>
> For publications in languages other than English, French or German,
> the translation of the copyright notice in the language of the
> publication shall be used.

If you intend to use the data commercially, please contact
EuroGeographics for information regarding their license agreements.

# Package index

## Political borders of Spain

These functions return [sf](https://CRAN.R-project.org/package=sf)
objects representing political borders.

### CartoBase ANE

Datasets from IGN / CartoBase ANE.

- [`esp_get_capimun()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_capimun.md)
  : City where the municipal public authorities are based - SIANE
- [`esp_get_ccaa_siane()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_ccaa_siane.md)
  : Autonomous Communities of Spain - SIANE
- [`esp_get_countries_siane()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_countries_siane.md)
  : Countries of the World - SIANE
- [`esp_get_munic_siane()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_munic_siane.md)
  : Municipalities of Spain - SIANE
- [`esp_get_prov_siane()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_prov_siane.md)
  : Provinces of Spain - SIANE
- [`esp_get_spain_siane()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_spain_siane.md)
  : Boundaries of Spain - SIANE
- [`esp_siane_bulk_download()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_siane_bulk_download.md)
  : SIANE bulk download

### GISCO

Datasets from GISCO / Eurostat.

- [`esp_get_ccaa()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_ccaa.md)
  : Autonomous Communities of Spain - GISCO
- [`esp_get_munic()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_munic.md)
  : Municipalities of Spain - GISCO
- [`esp_get_nuts()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_nuts.md)
  : Territorial Spanish units for statistics (NUTS) dataset
- [`esp_get_prov()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_prov.md)
  : Provinces of Spain - GISCO
- [`esp_get_spain()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_spain.md)
  : Boundaries of Spain - GISCO

### Other helpers and political objects

- [`esp_get_can_box()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_can_box.md)
  [`esp_get_can_provinces()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_can_box.md)
  : Canary Islands inset box and outline

- [`esp_move_can()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_move_can.md)
  :

  Displace a [`sf`](https://r-spatial.github.io/sf/reference/sf.html)
  object located in the Canary Islands

- [`esp_get_comarca()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_comarca.md)
  : 'Comarcas' of Spain

- [`esp_get_hex_prov()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_gridmap.md)
  [`esp_get_hex_ccaa()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_gridmap.md)
  [`esp_get_grid_prov()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_gridmap.md)
  [`esp_get_grid_ccaa()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_gridmap.md)
  :

  Get a [`sf`](https://r-spatial.github.io/sf/reference/sf.html) hexbin
  or squared `POLYGON` of Spain

- [`esp_get_simpl_prov()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_simpl.md)
  [`esp_get_simpl_ccaa()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_simpl.md)
  : Simplified map of provinces and autonomous communities of Spain

## Maps with images

Return static tiles or create an interactive
[leaflet](https://CRAN.R-project.org/package=leaflet) map.

- [`addProviderEspTiles()`](https://ropenspain.github.io/mapSpain/dev/reference/addProviderEspTiles.md)
  :

  Add a tile layer from Spanish public administrations on a
  [leaflet](https://CRAN.R-project.org/package=leaflet) map

- [`esp_get_tiles()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_tiles.md)
  : Get static tiles from public administrations of Spain

- [`esp_make_provider()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_make_provider.md)
  : Create a custom tile provider

- [`plotRGB(`*`<SpatRaster>`*`)`](https://rspatial.github.io/terra/reference/plotRGB.html)
  : Red-Green-Blue plot of a multi-layered SpatRaster (from terra)

- [`addProviderTiles()`](https://rstudio.github.io/leaflet/reference/addProviderTiles.html)
  [`providerTileOptions()`](https://rstudio.github.io/leaflet/reference/addProviderTiles.html)
  : Add a tile layer from a known map provider (from leaflet)

- [`geom_spatraster_rgb()`](https://dieghernan.github.io/tidyterra/reference/geom_spatraster_rgb.html)
  :

  Visualise `SpatRaster` objects as images (from tidyterra)

## Natural

These functions return [sf](https://CRAN.R-project.org/package=sf)
objects with natural features.

- [`esp_get_hydrobasin()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_hydrobasin.md)
  : River basin districts of Spain - SIANE
- [`esp_get_hypsobath()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_hypsobath.md)
  : Hypsometry and bathymetry of Spain - SIANE
- [`esp_get_rivers()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_landwater.md)
  [`esp_get_wetlands()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_landwater.md)
  : Rivers and wetlands of Spain - SIANE

## Infrastructures

These functions return [sf](https://CRAN.R-project.org/package=sf)
objects with man-made features.

- [`esp_get_railway()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_railway.md)
  [`esp_get_stations()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_railway.md)
  : Railways of Spain - SIANE
- [`esp_get_roads()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_roads.md)
  : Roads of Spain - SIANE

## Cache management

- [`esp_clear_cache()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_clear_cache.md)
  :

  Clear your [mapSpain](https://CRAN.R-project.org/package=mapSpain)
  cache dir

- [`esp_set_cache_dir()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_set_cache_dir.md)
  [`esp_detect_cache_dir()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_set_cache_dir.md)
  :

  Set your [mapSpain](https://CRAN.R-project.org/package=mapSpain) cache
  dir

## Dictionary

Translation across languages and coding systems.

- [`esp_dict_region_code()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_dict.md)
  [`esp_dict_translate()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_dict.md)
  : Convert and translate Spanish subdivision names and codes

## Datasets

Datasets included with
[mapSpain](https://CRAN.R-project.org/package=mapSpain).

- [`esp_codelist`](https://ropenspain.github.io/mapSpain/dev/reference/esp_codelist.md)
  : Database with codes and names of Spanish regions

- [`esp_nuts_2024`](https://ropenspain.github.io/mapSpain/dev/reference/esp_nuts_2024.md)
  :

  NUTS 2024 for Spain
  [`sf`](https://r-spatial.github.io/sf/reference/sf.html) object

- [`esp_tiles_providers`](https://ropenspain.github.io/mapSpain/dev/reference/esp_tiles_providers.md)
  : Public WMS and WMTS providers for Spain

- [`pobmun25`](https://ropenspain.github.io/mapSpain/dev/reference/pobmun25.md)
  : Population of Spain by municipality (2025)

## Geographical grids

Geographical grids are agreed, defined and harmonised grid nets with
standardised location and size of grid cells.

- [`esp_get_grid_BDN()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_grid_BDN.md)
  [`esp_get_grid_BDN_ccaa()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_grid_BDN.md)
  : National geographic grids from BDN (Nature Data Bank)
- [`esp_get_grid_ESDAC()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_grid_ESDAC.md)
  : National geographic grids from the European Soil Data Centre (ESDAC)
- [`esp_get_grid_MTN()`](https://ropenspain.github.io/mapSpain/dev/reference/esp_get_grid_MTN.md)
  : National geographic grids from IGN MTN ((Mapa Topografico Nacional)

## About the package

- [`mapSpain`](https://ropenspain.github.io/mapSpain/dev/reference/mapSpain-package.md)
  [`mapSpain-package`](https://ropenspain.github.io/mapSpain/dev/reference/mapSpain-package.md)
  : mapSpain: Administrative Boundaries of Spain

# Articles

### All articles

- [Working with
  imagery](https://ropenspain.github.io/mapSpain/dev/articles/working_imagery.md):

  Learn how to include images on your maps.

- [mapSpain: Mapas de España en R
  \[Spanish\]](https://ropenspain.github.io/mapSpain/dev/articles/mapasesp.md):

  Mapas de España en R de forma rápida y sencilla.

- [Annex: Codes and names of the Spanish
  regions](https://ropenspain.github.io/mapSpain/dev/articles/regioncodes.md):

  Interactive explorer of the data included in the package.
